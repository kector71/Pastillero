<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EL PASTILLERO ðŸ’Š</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      transition: background-color 0.3s, color 0.3s;
    }
    .dark {
      background-color: #1f2937;
      color: #f9fafb;
    }
    .dark table {
      color: #f9fafb;
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Header -->
  <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white">
    <div class="container mx-auto px-4 py-8 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-2">EL PASTILLERO ðŸ’Š</h1>
      <p class="text-xl md:text-2xl opacity-90">CatÃ¡logo de pastillas de freno</p>
    </div>
  </header>

  <!-- Filtros -->
  <section class="container mx-auto px-4 py-8">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8">
      <div class="flex flex-wrap justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-200">Filtrar resultados</h2>
        <div class="flex gap-2">
          <button id="toggle-dark" class="bg-gray-700 text-white px-3 py-2 rounded-md hover:bg-gray-600">ðŸŒ™ Modo oscuro</button>
          <button id="limpiar" class="bg-red-500 text-white px-3 py-2 rounded-md hover:bg-red-600">ðŸ§¹ Limpiar filtros</button>
        </div>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">MARCA</label>
          <select id="marca" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
            <option value="">Todas</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">MODELO</label>
          <select id="modelo" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" disabled>
            <option value="">Todos</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">DESDE (AÃ±o)</label>
          <input type="number" id="desde" min="1900" max="2024" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">HASTA (AÃ±o)</label>
          <input type="number" id="hasta" min="1900" max="2024" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
        </div>
      </div>

      <input type="text" id="busqueda" placeholder="ðŸ” Buscar por palabra clave..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
    </div>

    <!-- Tabla de resultados -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50 dark:bg-gray-700">
            <tr>
              <th class="px-6 py-3 font-bold text-left">MARCA</th>
              <th class="px-6 py-3 font-bold text-left">MODELO</th>
              <th class="px-6 py-3 font-bold text-left">DESDE</th>
              <th class="px-6 py-3 font-bold text-left">HASTA</th>
              <th class="px-6 py-3 font-bold text-left">POSICIÃ“N</th>
              <th class="px-6 py-3 font-bold text-left">REF INCOLBEST</th>
              <th class="px-6 py-3 font-bold text-left">PLATINA FMSI</th>
            </tr>
          </thead>
          <tbody id="table-body" class="divide-y divide-gray-200 dark:divide-gray-700"></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white mt-12">
    <div class="container mx-auto px-4 py-8 text-center">
      <h3 class="text-xl font-bold">EL PASTILLERO ðŸ’Š</h3>
      <div class="mt-4 text-sm text-gray-400">
        Â© 2025 EL PASTILLERO ðŸ’Š. Todos los derechos reservados.
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const marcaSelect = document.getElementById('marca');
      const modeloSelect = document.getElementById('modelo');
      const desdeInput = document.getElementById('desde');
      const hastaInput = document.getElementById('hasta');
      const busquedaInput = document.getElementById('busqueda');
      const tableBody = document.getElementById('table-body');
      const limpiarBtn = document.getElementById('limpiar');
      const toggleDark = document.getElementById('toggle-dark');

      let data = [];

      // ðŸŒ™ Modo oscuro
      toggleDark.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        toggleDark.textContent = document.body.classList.contains('dark') ? 'â˜€ï¸ Modo claro' : 'ðŸŒ™ Modo oscuro';
      });

      // Cargar el JSON
      try {
        const res = await fetch('pastillas.json');
        data = await res.json();
        renderTable(data);
        cargarMarcas(data);
      } catch (error) {
        console.error('Error al cargar el JSON:', error);
      }

      function renderTable(lista) {
        tableBody.innerHTML = '';
        lista.forEach(item => {
          const row = `
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
              <td class="px-6 py-4">${item.marca}</td>
              <td class="px-6 py-4">${item.modelo}</td>
              <td class="px-6 py-4">${item.desde}</td>
              <td class="px-6 py-4">${item.hasta}</td>
              <td class="px-6 py-4">${item.posicion}</td>
              <td class="px-6 py-4">${item.ref}</td>
              <td class="px-6 py-4">${item.fmsi}</td>
            </tr>
          `;
          tableBody.insertAdjacentHTML('beforeend', row);
        });
      }

      function cargarMarcas(data) {
        const marcas = [...new Set(data.map(item => item.marca))].sort();
        marcas.forEach(m => {
          const option = document.createElement('option');
          option.value = m;
          option.textContent = m;
          marcaSelect.appendChild(option);
        });
      }

      function cargarModelos(marca) {
        modeloSelect.innerHTML = '<option value="">Todos</option>';
        const modelos = [...new Set(data.filter(i => i.marca === marca).map(i => i.modelo))].sort();
        modelos.forEach(m => {
          const option = document.createElement('option');
          option.value = m;
          option.textContent = m;
          modeloSelect.appendChild(option);
        });
        modeloSelect.disabled = modelos.length === 0;
      }

      function filterTable() {
        const marca = marcaSelect.value;
        const modelo = modeloSelect.value;
        const desde = desdeInput.value ? parseInt(desdeInput.value) : null;
        const hasta = hastaInput.value ? parseInt(hastaInput.value) : null;
        const search = busquedaInput.value.toLowerCase();

        const filtrados = data.filter(item => {
          const matchesMarca = !marca || item.marca === marca;
          const matchesModelo = !modelo || item.modelo === modelo;
          const matchesDesde = !desde || item.desde >= desde;
          const matchesHasta = !hasta || item.hasta <= hasta;
          const matchesSearch = Object.values(item).join(' ').toLowerCase().includes(search);
          return matchesMarca && matchesModelo && matchesDesde && matchesHasta && matchesSearch;
        });

        renderTable(filtrados);
      }

      // ðŸ§¹ Limpiar filtros
      limpiarBtn.addEventListener('click', () => {
        marcaSelect.value = '';
        modeloSelect.value = '';
        modeloSelect.disabled = true;
        desdeInput.value = '';
        hastaInput.value = '';
        busquedaInput.value = '';
        renderTable(data);
      });

      marcaSelect.addEventListener('change', () => {
        cargarModelos(marcaSelect.value);
        filterTable();
      });
      modeloSelect.addEventListener('change', filterTable);
      desdeInput.addEventListener('input', filterTable);
      hastaInput.addEventListener('input', filterTable);
      busquedaInput.addEventListener('input', filterTable);
    });
  </script>
</body>
</html>