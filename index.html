<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brake X - Consulta de Pastillas</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ================== VARIABLES DE TEMA ================== */
        :root {
            --bg-color: #f0f0f0;
            --text-color: #000;
            --header-border-color: rgba(0,0,0,0.2);
            --header-x-fill: #000;
            --glass-bg: rgba(255,255,255,0.15);
            --glass-border: rgba(255,255,255,0.3);
            --input-bg: rgba(255,255,255,0.25);
            --input-border: rgba(0,0,0,0.15);
            --input-focus-border: #2563eb;
            --input-focus-bg: rgba(255,255,255,0.35);
            --btn-bg: rgba(255,255,255,0.25);
            --btn-border: rgba(0,0,0,0.15);
            --card-bg: rgba(255,255,255,0.25);
            --card-border: rgba(255,255,255,0.3);
            --liquid-glass-bg: linear-gradient(145deg, rgba(255,255,255,0.85), rgba(255,255,255,0.7) 60%);
            --liquid-glass-shadow: 0 5px 10px rgba(0,0,0,0.25), inset 0 0 18px rgba(255,255,255,0.3);
            --icon-sun-stroke: #000;
            --icon-moon-stroke: #fff;
            --icon-arrow-stroke: #007AFF;
            --arrow-glow-animation: arrow-glow 1.5s ease-in-out infinite alternate;
        }

        body.lp-dark {
            --bg-color: #000;
            --text-color: #fff;
            --header-border-color: rgba(255,255,255,0.2);
            --header-x-fill: #fff;
            --glass-bg: rgba(50,50,50,0.2);
            --glass-border: rgba(255,255,255,0.1);
            --input-bg: rgba(0,0,0,0.2);
            --input-border: rgba(255,255,255,0.15);
            --input-focus-border: #60a5fa;
            --input-focus-bg: rgba(0,0,0,0.3);
            --btn-bg: rgba(0,0,0,0.2);
            --btn-border: rgba(255,255,255,0.15);
            --card-bg: rgba(50,50,50,0.2);
            --card-border: rgba(255,255,255,0.1);
            --liquid-glass-bg: linear-gradient(145deg, rgba(50,50,50,0.9), rgba(30,30,30,0.85) 60%);
            --liquid-glass-shadow: 0 5px 10px rgba(0,0,0,0.4), inset 0 0 18px rgba(255,255,255,0.1);
            --icon-sun-stroke: #fff;
            --arrow-glow-animation: arrow-glow-dark 1.5s ease-in-out infinite alternate;
        }

        /* ================== GENERAL & BODY ================== */
        * { box-sizing: border-box; margin:0; padding:0; }
        html, body { height:100%; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; }
        body {    
            background: var(--bg-color);    
            transition: background 0.5s ease, color 0.5s ease;    
            color: var(--text-color);
            padding: 1rem;
        }

        /* ================== HEADER ================== */
        header {
            width: 100%; max-width: 1200px; margin: 0 auto 1.5rem auto; text-align: center;
        }
        header h1 {
            font-family: 'Orbitron', sans-serif; font-size: 1.2rem; font-weight: 700; letter-spacing: 1px; color: inherit;
            display: flex; align-items: center; justify-content: center; gap: 12px;
            opacity: 0; animation: fadeDown 1s ease 0.3s forwards; white-space: nowrap;
        }
        .header-subtitle {
            font-size: 0.9rem; font-weight: 500; opacity: 0.8;
            border-left: 2px solid var(--header-border-color); padding-left: 12px;
            transition: border-color 0.5s ease;
        }
        header .header-x {
            height: 1.1em; width: auto; display: inline-block;
            vertical-align: middle; transition: transform 0.6s ease;
        }
        header .header-x path { 
            fill: var(--header-x-fill);
            transition: fill 0.5s ease; 
        }

        /* ================== ESTRUCTURA PRINCIPAL ================== */
        .main-layout { max-width: 1200px; margin: 0 auto; display: flex; gap: 1.5rem; align-items: flex-start; }
        
        /* Contenedor para la columna de filtros */
        .filters-column {
            flex: 0 0 320px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Espacio entre las tarjetas de filtros */
        }
        .results-panel { flex: 1; }

        /* ================== ESTILOS DE FILTROS Y TARJETAS ================== */
        .glass {
            background-color: var(--glass-bg);    
            backdrop-filter: blur(12px);
            border:1px solid var(--glass-border);    
            border-radius:1rem; padding:1.5rem;    
        }
        .filter-title { font-weight:600; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .form-input {
            width: 100%; padding: 12px; border-radius: 12px;
            border: 1px solid var(--input-border); background-color: var(--input-bg);
            color: var(--text-color); font-size: 0.9rem; transition: all 0.3s ease; box-sizing: border-box;
        }
        .form-input:focus { 
            border-color: var(--input-focus-border); 
            outline:none; 
            background-color: var(--input-focus-bg); 
        }
        .filter-group { display: flex; flex-direction: column; gap: 0.8rem; margin-bottom: 1rem; }
        .filter-group:last-child { margin-bottom: 0; }
        
        .position-container { display:flex; gap:0.5rem; }
        .position-btn {
            flex:1; min-width:100px; padding: 12px; border-radius:12px; border:1px solid var(--btn-border);
            cursor:pointer; font-size:0.9rem; text-align:center; transition: all 0.3s ease;
            background-color: var(--btn-bg); color: var(--text-color);
        }
        #positionDelantera.active { background-color: #60a5fa; border-color: #3b82f6; color: #fff; }
        #positionTras.active { background-color: #f87171; border-color: #ef4444; color: #fff; }
        .input-group-horizontal { display:flex; gap:0.5rem; }
        .input-group-horizontal .form-input { flex:1; }
        .result-count-container { font-size:0.75rem; color:#4b5563; margin-top: 1rem; }

        .results-wrapper { display:grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap:0.75rem; }
        .result-card {
            background-color: var(--card-bg); backdrop-filter: blur(10px);
            border-radius:1rem; padding:1rem; border:1px solid var(--card-border);
            display:flex; flex-direction:column; gap:0.25rem;
            opacity:0; transform: translateY(10px); animation: fadeInUp 0.3s forwards;
        }
        .result-field { font-size:0.9rem; }
        .result-image { width:100%; height:auto; border-radius:0.75rem; object-fit:cover; margin-bottom:0.5rem; }
        .position-badge { display:inline-block; padding:0.3rem 0.5rem; border-radius:0.4rem; font-size:0.75rem; font-weight:500; text-align:center; }
        .position-delantera { background-color:#dbeafe; color:#1d4ed8; }
        .position-trasera { background-color:#fef2f2; color:#b91c1c; }
        .no-results { text-align:center; padding: 2rem 0; opacity: 0.7; grid-column: 1 / -1; }

        /* ================== FLOATING BUTTONS ================== */
        .floating-buttons-container { position: fixed; bottom: 18px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .floating-buttons-container.left { left: 18px; }
        .floating-buttons-container.right { right: 18px; }
        .liquid-glass {
            position: relative; width: 50px; height: 50px; border-radius: 50%;
            background: var(--liquid-glass-bg);
            box-shadow: var(--liquid-glass-shadow);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; overflow: hidden;
            transition: all 0.35s cubic-bezier(0.68,-0.55,0.27,1.55);
            backdrop-filter: blur(8px); border:none; outline:none;
        }
        .liquid-glass svg {
            width: 20px; height: 20px; fill:none; stroke-width:2; position:absolute;
            transition: opacity 0.4s, transform 0.4s, stroke 0.4s, filter 0.4s;
        }
        .liquid-glass:focus { outline:none; box-shadow:0 0 0 3px rgba(0,122,255,0.5); }
        .lp-icon-sun { stroke: var(--icon-sun-stroke); }    
        .lp-icon-moon { stroke: var(--icon-moon-stroke); }
        .lp-icon-arrow { 
            stroke: var(--icon-arrow-stroke); 
            animation: var(--arrow-glow-animation); 
        }
        #upBtn { opacity: 0; transform: translateY(40px); pointer-events: none; transition: opacity 0.3s ease, transform 0.3s ease; }
        #upBtn.show { opacity: 1; pointer-events: auto; animation: slide-bounce 0.5s ease forwards; }

        /* ================== ANIMATIONS ================== */
        @keyframes fadeDown { 0% { opacity:0; transform:translateY(-8px); } 100% { opacity:1; transform:translateY(0); } }
        @keyframes bounceHeader { 0% { transform: scale(1); } 30% { transform: scale(1.15); } 50% { transform: scale(0.95); } 70% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes arrow-glow { 0% { filter: drop-shadow(0 0 2px rgba(0,122,255,0.4)); } 50% { filter: drop-shadow(0 0 6px rgba(0,122,255,0.8)); } 100% { filter: drop-shadow(0 0 2px rgba(0,122,255,0.4)); } }
        @keyframes arrow-glow-dark { 0% { filter: drop-shadow(0 0 2px rgba(255,255,255,0.4)); } 50% { filter: drop-shadow(0 0 6px rgba(255,255,255,0.8)); } 100% { filter: drop-shadow(0 0 2px rgba(255,255,255,0.4)); } }
        @keyframes slide-bounce { 0% { transform: translateY(40px) scale(0.8); opacity:0; } 60% { transform: translateY(-5px) scale(1.05); opacity:1; } 100% { transform: translateY(0) scale(1); opacity:1; } }
        @keyframes fadeInUp { to { opacity:1; transform: translateY(0); } }

        /* ================== RESPONSIVE ADJUSTMENTS ================== */
        @media (max-width: 992px) {
            .main-layout { flex-direction: column; }
            .filters-column { flex-basis: auto; width: 100%; }
        }
        @media (max-width: 768px) {
            .floating-buttons-container { bottom: calc(env(safe-area-inset-bottom, 10px) + 8px); }
            .header-subtitle { display: none; }
        }
        @media (max-width: 600px) {
            body { padding: 0.5rem; }
            .glass { padding: 1rem; }
            .position-container{ flex-direction: row; }
            .form-input, .position-btn { font-size: 1rem; padding: 1rem; }
            .result-field{ font-size:0.9rem; }
            .input-group-horizontal{ flex-direction:column; }
        }
        @media (max-width: 480px) {
            header h1 { font-size: 1rem; }
            .form-input, .position-btn { font-size: 0.9rem; padding: 0.8rem; }
        }
    </style>
</head>
<body>

    <header>
        <h1>
            Brake
            <svg class="header-x" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 24"><path d="M8.98885921,23.8523026 C8.8942483,23.9435442 8.76801031,24 8.62933774,24 L2.03198365,24 C1.73814918,24 1.5,23.7482301 1.5,23.4380086 C1.5,23.2831829 1.55946972,23.1428989 1.65570253,23.0416777 L13.2166154,12.4291351 C13.3325814,12.3262031 13.4061076,12.1719477 13.4061076,11.999444 C13.4061076,11.8363496 13.3401502,11.6897927 13.2352673,11.587431 L1.68841087,0.990000249 C1.57298556,0.88706828 1.5,0.733668282 1.5,0.561734827 C1.5,0.251798399 1.73814918,2.85130108e-05 2.03198365,2.85130108e-05 L8.62933774,2.85130108e-05 C8.76855094,2.85130108e-05 8.89532956,0.0561991444 8.98994048,0.148296169 L21.4358709,11.5757407 C21.548593,11.6783875 21.6196864,11.8297916 21.6196864,11.999444 C21.6196864,12.1693815 21.5483227,12.3219261 21.4350599,12.4251432 L8.98885921,23.8523026 Z M26.5774333,23.8384453 L20.1765996,17.9616286 C20.060093,17.8578413 19.9865669,17.703871 19.9865669,17.5310822 C19.9865669,17.3859509 20.0390083,17.2536506 20.1246988,17.153855 L23.4190508,14.1291948 C23.5163648,14.0165684 23.6569296,13.945571 23.8131728,13.945571 C23.9602252,13.945571 24.0929508,14.0082997 24.1894539,14.1092357 L33.861933,22.9913237 C33.9892522,23.0939706 34.0714286,23.2559245 34.0714286,23.4381226 C34.0714286,23.748059 33.8332794,23.9998289 33.5394449,23.9998289 L26.9504707,23.9998289 C26.8053105,23.9998289 26.6733958,23.9382408 26.5774333,23.8384453 Z M26.5774333,0.161098511 C26.6733958,0.0615881034 26.8053105,0 26.9504707,0 L33.5394449,0 C33.8332794,0 34.0714286,0.251769886 34.0714286,0.561706314 C34.0714286,0.743904453 33.9892522,0.905573224 33.861933,1.00822006 L24.1894539,9.89030807 C24.0929508,9.99152926 23.9602252,10.0542579 23.8131728,10.0542579 C23.6569296,10.0542579 23.5163648,9.98354562 23.4190508,9.87063409 L20.1246988,6.8459739 C20.0390083,6.74617837 19.9865669,6.613878 19.9865669,6.46874677 C19.9865669,6.29624305 20.060093,6.14198767 20.1765996,6.03848544 L26.5774333,0.161098511 Z" /></svg>
            <span class="header-subtitle">Consulta rápida. Frenado seguro.</span>
        </h1>
    </header>

    <div class="main-layout">
        <div class="filters-column">
            
            <div class="glass">
                <div class="filter-title">Búsqueda rápida</div>
                <input type="text" id="busquedaRapida" placeholder="Marca, Modelo, Ref, OEM..." class="form-input">
            </div>

            <div class="glass">
                <div class="filter-group">
                    <div class="filter-title">Detalles del vehículo</div>
                    <input list="marcas" id="filtroMarca" class="form-input" placeholder="Marca"><datalist id="marcas"></datalist>
                    <input list="modelos" id="filtroModelo" class="form-input" placeholder="Modelo"><datalist id="modelos"></datalist>
                    <input list="anios" id="filtroAnio" class="form-input" placeholder="Año"><datalist id="anios"></datalist>
                </div>
    
                <div class="filter-group">
                    <div class="filter-title">Posición</div>
                    <div class="position-container">
                        <div class="position-btn" id="positionDelantera">Delantera</div>
                        <div class="position-btn" id="positionTras">Trasera</div>
                    </div>
                </div>
    
                <div class="filter-group">
                    <div class="filter-title">Referencias y códigos</div>
                    <div class="input-group-horizontal">
                        <input list="oemList" id="filtroOem" class="form-input" placeholder="OEM"><datalist id="oemList"></datalist>
                        <input list="fmsiList" id="filtroFmsi" class="form-input" placeholder="Platina FMSI"><datalist id="fmsiList"></datalist>
                    </div>
                </div>
    
                <div class="filter-group">
                    <div class="filter-title">Medidas</div>
                    <div class="input-group-horizontal">
                        <input type="number" id="medidasAncho" placeholder="Ancho (mm)" class="form-input">
                        <input type="number" id="medidasAlto" placeholder="Alto (mm)" class="form-input">
                    </div>
                </div>
            </div>

        </div>

        <div class="results-panel">
            <div class="results-wrapper" id="results-container"></div>
            <div class="result-count-container"> <span id="resultCount">0</span> resultados </div>
        </div>
    </div>

    <div class="floating-buttons-container left">
        <button class="liquid-glass" id="upBtn" aria-label="Subir al inicio de la página"><svg class="lp-icon-arrow" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="5,12 12,5 19,12"></polyline></svg></button>
    </div>

    <div class="floating-buttons-container right">
        <button class="liquid-glass" id="darkBtn" aria-label="Cambiar modo oscuro" aria-pressed="false"><svg class="lp-icon-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="4"></line><line x1="12" y1="20" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="6.34" y2="6.34"></line><line x1="17.66" y1="17.66" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="4" y2="12"></line><line x1="20" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="6.34" y2="17.66"></line><line x1="17.66" y1="6.34" x2="19.78" y2="4.22"></line></svg><svg class="lp-icon-moon" viewBox="0 0 24 24" style="opacity:0;"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
    
            let brakePadsData = [];
            const els = {
                body: document.body, headerX: document.querySelector('.header-x'), darkBtn: document.getElementById('darkBtn'),    
                sunIcon: document.querySelector('.lp-icon-sun'), moonIcon: document.querySelector('.lp-icon-moon'),    
                upBtn: document.getElementById('upBtn'),    
                busqueda: document.getElementById('busquedaRapida'), marca: document.getElementById('filtroMarca'),    
                modelo: document.getElementById('filtroModelo'), anio: document.getElementById('filtroAnio'),    
                oem: document.getElementById('filtroOem'), fmsi: document.getElementById('filtroFmsi'),    
                medidasAncho: document.getElementById('medidasAncho'), medidasAlto: document.getElementById('medidasAlto'),    
                posDel: document.getElementById('positionDelantera'), posTras: document.getElementById('positionTras'),    
                datalistMarca: document.getElementById('marcas'), datalistModelo: document.getElementById('modelos'),    
                datalistAnio: document.getElementById('anios'), datalistOem: document.getElementById('oemList'),    
                datalistFmsi: document.getElementById('fmsiList'), results: document.getElementById('results-container'),    
                count: document.getElementById('resultCount')    
            };
                
            const debounce = (func, delay) => {
                let timeout;
                return (...args) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(this, args), delay);
                };
            };

            const fillDatalist = (datalist, values) => {
                datalist.innerHTML = values.map(v => `<option value="${v}">`).join('');
            };

            const getPositionFilter = () => {
                const isDelActive = els.posDel.classList.contains('active');
                const isTrasActive = els.posTras.classList.contains('active');
                if (isDelActive && !isTrasActive) return 'Delantera';
                if (!isDelActive && isTrasActive) return 'Trasera';
                return 'Todas';
            };

            const filterData = () => {
                if (!brakePadsData.length) return;
                const fbusq = (val) => val.toLowerCase().trim();
                const filters = {
                    busqueda: fbusq(els.busqueda.value), marca: els.marca.value, modelo: els.modelo.value,
                    anio: els.anio.value, oem: els.oem.value, fmsi: els.fmsi.value,
                    ancho: parseFloat(els.medidasAncho.value), alto: parseFloat(els.medidasAlto.value),
                    pos: getPositionFilter()
                };
                const filtered = brakePadsData.filter(item => {
                    const busqMatch = !filters.busqueda || ['marca', 'modelo', 'ref', 'oem', 'fmsi'].some(key => item[key]?.toLowerCase().includes(filters.busqueda));
                    const anchoMatch = !filters.ancho || item.anchoNum === filters.ancho;
                    const altoMatch = !filters.alto || item.altoNum === filters.alto;
                    const posMatch = filters.pos === 'Todas' || item.posición === filters.pos;
                    return busqMatch && (!filters.marca || item.marca === filters.marca) && (!filters.modelo || item.modelo === filters.modelo) && (!filters.anio || item.año === filters.anio) && (!filters.oem || item.oem === filters.oem) && (!filters.fmsi || item.fmsi === filters.fmsi) && anchoMatch && altoMatch && posMatch;
                });
                renderResults(filtered);
            };

            const renderResults = (filteredData) => {
                els.count.textContent = filteredData.length;
                if (filteredData.length === 0) {
                    els.results.innerHTML = `<p class="no-results">No se encontraron pastillas con los filtros seleccionados.</p>`;
                    return;
                }
                els.results.innerHTML = filteredData.map(item => {
                    const posBadge = item.posición === 'Delantera'
                        ? '<span class="position-badge position-delantera">Delantera</span>'
                        : '<span class="position-badge position-trasera">Trasera</span>';
                    return `<div class="result-card">
                                <img src="${item.imagen}" alt="${item.marca} ${item.modelo}" class="result-image" loading="lazy">
                                <div class="result-field"><strong>${item.marca} ${item.modelo} (${item.ref})</strong></div>
                                <div class="result-field">Año: ${item.año}</div>
                                <div class="result-field">OEM: ${item.oem}</div>
                                <div class="result-field">FMSI: ${item.fmsi}</div>
                                <div class="result-field">${posBadge}</div>
                                <div class="result-field">Medidas: ${item.medidas}</div>
                            </div>`;
                }).join('');
            };

            function setupEventListeners() {
                els.darkBtn.addEventListener('click', () => {
                    const isDark = els.body.classList.toggle('lp-dark');
                    els.darkBtn.setAttribute('aria-pressed', String(isDark));
                    const iconAnimation = (icon, isShowing) => {
                        const keyframes = isShowing
                            ? [{ opacity: 0, transform: 'scale(0.6)' }, { opacity: 1, transform: 'scale(1)' }]
                            : [{ opacity: 1, transform: 'scale(1)' }, { opacity: 0, transform: 'scale(0.6)' }];
                        icon.animate(keyframes, { duration: 400, fill: 'forwards', easing: 'ease-in-out' });
                    };
                    iconAnimation(els.sunIcon, !isDark);
                    iconAnimation(els.moonIcon, isDark);
                    els.headerX.style.animation = 'bounceHeader 0.6s cubic-bezier(0.68,-0.55,0.27,1.55)';
                    setTimeout(() => { els.headerX.style.animation = ''; }, 600);
                });

                els.upBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
                window.addEventListener('scroll', () => els.upBtn.classList.toggle('show', window.scrollY > 150));

                const debouncedFilter = debounce(filterData, 300);
                const filterInputs = [els.busqueda, els.marca, els.modelo, els.anio, els.oem, els.fmsi, els.medidasAncho, els.medidasAlto];
                filterInputs.forEach(input => input.addEventListener('input', debouncedFilter));

                [els.posDel, els.posTras].forEach(btn => btn.addEventListener('click', () => {
                    btn.classList.toggle('active');
                    filterData();
                }));
            }

            async function inicializarApp() {
                try {
                    const response = await fetch('pastillas.json');
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    const data = await response.json();

                    brakePadsData = data.map(item => {
                        const partes = item.medidas.split('x').map(s => parseFloat(s.trim()));
                        return { ...item, anchoNum: partes[0] || 0, altoNum: partes[1] || 0 };
                    });

                    const uniqueValues = (key) => [...new Set(brakePadsData.map(d => d[key]))].sort();
                    fillDatalist(els.datalistMarca, uniqueValues('marca'));
                    fillDatalist(els.datalistModelo, uniqueValues('modelo'));
                    fillDatalist(els.datalistAnio, uniqueValues('año'));
                    fillDatalist(els.datalistOem, uniqueValues('oem'));
                    fillDatalist(els.datalistFmsi, uniqueValues('fmsi'));
                    
                    filterData();
                } catch (error) {
                    console.error("No se pudieron cargar los datos de las pastillas:", error);
                    els.results.innerHTML = `<p class="no-results">Error al cargar los datos. Por favor, intente de nuevo más tarde.</p>`;
                }
            }

            setupEventListeners();
            inicializarApp();
        });
    </script>
</body>
</html>
