<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filtro Vehículos con Papelera Animada</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  margin:0; padding:2rem;
  background: linear-gradient(135deg, #f0f0f0, #d9d9d9);
  min-height:100vh;
  color:#000;
}

.glass {
  background-color: rgba(255,255,255,0.15); backdrop-filter: blur(12px);
  border:1px solid rgba(255,255,255,0.3); border-radius:1rem;
  padding:1.5rem; max-width:700px; margin:0 auto;
  display:flex; flex-direction:column; gap:1rem;
}

.filter-title { font-weight:600; font-size:1rem; }

.form-input {
  width: 100%;
  padding: 1rem;
  border-radius: 1rem;
  border: 1px solid rgba(0,0,0,0.15);
  background-color: rgba(255,255,255,0.25);
  color: #000;
  font-size: 1rem;
  transition: all 0.3s ease;
  box-sizing: border-box;
  margin-bottom: 0.5rem;
}
.form-input:focus { border-color:#2563eb; outline:none; background-color: rgba(255,255,255,0.35); }

.position-container {
  display:flex; gap:0.5rem; flex-wrap:wrap; justify-content:center;
}
.position-btn {
  flex:1; min-width:140px; max-width:180px; padding:1rem; border-radius:1rem; border:1px solid rgba(0,0,0,0.15);
  cursor:pointer; font-size:1rem; text-align:center; transition: all 0.3s ease;
  background-color: rgba(255,255,255,0.25); color: #000;
}
#positionDelantera.active { background-color: #60a5fa; border-color: #3b82f6; color: #fff; }
#positionTras.active { background-color: #f87171; border-color: #ef4444; color: #fff; }

.results-wrapper { 
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap:0.75rem;
  max-width:1200px;
  margin:0 auto;
}
.result-card {
  background-color: rgba(255,255,255,0.25); backdrop-filter: blur(10px);
  border-radius:1rem; padding:1rem; border:1px solid rgba(255,255,255,0.3);
  display:flex; flex-direction:column; gap:0.25rem; position:relative;
  opacity:0; transform: translateY(10px);
  animation: fadeInUp 0.3s forwards;
}
@keyframes fadeInUp {
  to { opacity:1; transform: translateY(0); }
}

.result-field{ font-size:0.9rem; }
.result-image{
  width:100%; height:auto; border-radius:0.75rem; object-fit:cover; margin-bottom:0.5rem;
}

.position-badge{ display:inline-block; padding:0.3rem 0.5rem; border-radius:0.4rem; font-size:0.75rem; font-weight:500; margin-right:0.25rem; text-align:center; }
.position-delantera{ background-color:#dbeafe; color:#1d4ed8; }
.position-trasera{ background-color:#fef2f2; color:#b91c1c; }

.medidas-container { display:flex; gap:0.5rem; flex-wrap:wrap; }

@media(max-width:600px){
  .position-container{ flex-direction:column; }
  .form-input{ font-size:1.1rem; padding:1.2rem; }
  .position-btn{ font-size:1.1rem; padding:1.2rem; min-width:auto; max-width:none; }
  .result-field{ font-size:1rem; }
  .medidas-container{ flex-direction:column; }
}

/* Botón Papelera Redondo Cristal Líquido */
.lp-fbtn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 64px;
  height: 64px;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(20px) saturate(250%) brightness(1.3);
  box-shadow: 0 12px 30px rgba(0,0,0,.25), inset 0 0 8px rgba(255,255,255,0.2);
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  z-index: 9999;
  transition: transform .25s, box-shadow .25s, background .35s;
  animation: lp-float 2s ease-in-out infinite;
}
.lp-fbtn::before {
  content: '';
  position: absolute;
  top:0; left:0;
  width:100%; height:100%;
  border-radius:50%;
  pointer-events:none;
  background: radial-gradient(circle at var(--mx,50%) var(--my,50%),rgba(255,255,255,0.25),transparent 70%);
  mix-blend-mode: screen;
  filter: blur(6px);
  transition: transform .2s;
}
@keyframes lp-float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
.lp-fbtn.lp-bounce:hover { animation: lp-bounce .4s; }
@keyframes lp-bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
.lp-fbtn.lp-shake:active { animation: lp-shake .3s; }
@keyframes lp-shake { 0% { transform: translateX(0); } 20% { transform: translateX(-2px); } 40% { transform: translateX(2px); } 60% { transform: translateX(-2px); } 80% { transform: translateX(2px); } 100% { transform: translateX(0); } }
.lp-spark { position: fixed; border-radius: 50%; pointer-events: none; opacity: 0.9; filter: blur(1px); animation: sparkFall 0.8s forwards, sparkTwinkle 0.15s infinite alternate; }
@keyframes sparkFall { 0% { transform: translate(0,0) rotate(0deg) scale(1); opacity: 1; } 100% { transform: translate(var(--dx,60px), var(--dy,140px)) rotate(720deg) scale(0); opacity: 0; } }
@keyframes sparkTwinkle { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
@keyframes lidOpen { 0% { transform: rotate(0deg) translateY(0); } 50% { transform: rotate(-25deg) translateY(-2px); } 100% { transform: rotate(0deg) translateY(0); } }

</style>
</head>
<body>

<div class="glass">

  <div class="filter-title">Búsqueda rápida</div>
  <input type="text" id="busquedaRapida" placeholder="Marca, Modelo, Ref..." class="form-input">

  <div class="filter-title">Detalles del vehículo</div>
  <input list="marcas" id="filtroMarca" class="form-input" placeholder="Marca">
  <datalist id="marcas"></datalist>

  <input list="modelos" id="filtroModelo" class="form-input" placeholder="Modelo">
  <datalist id="modelos"></datalist>

  <input list="anios" id="filtroAnio" class="form-input" placeholder="Año">
  <datalist id="anios"></datalist>

  <div class="filter-title">Medidas</div>
  <div class="medidas-container">
    <input type="number" id="medidasAncho" placeholder="Ancho (mm)" class="form-input" style="flex:1">
    <input type="number" id="medidasAlto" placeholder="Alto (mm)" class="form-input" style="flex:1">
  </div>

  <div class="filter-title">Referencias y códigos</div>
  <input list="oemList" id="filtroOem" class="form-input" placeholder="OEM">
  <datalist id="oemList"></datalist>

  <input list="fmsiList" id="filtroFmsi" class="form-input" placeholder="Platina FMSI">
  <datalist id="fmsiList"></datalist>

  <div class="filter-title">Posición</div>
  <div class="position-container">
    <div class="position-btn" id="positionDelantera">Delantera</div>
    <div class="position-btn" id="positionTras">Trasera</div>
  </div>

  <div class="results-wrapper" id="results-container"></div>
  <div style="font-size:0.75rem; color:#4b5563;"> <span id="resultCount">0</span> resultados </div>
</div>

<!-- Papelera animada -->
<button id="trashBtn" class="lp-fbtn lp-bounce lp-shake">
  <svg viewBox="0 0 64 64" width="32" height="32">
    <defs>
      <linearGradient id="grad1" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="#888"/>
        <stop offset="100%" stop-color="#444"/>
      </linearGradient>
    </defs>
    <rect x="20" y="22" width="24" height="28" rx="4" ry="4" fill="url(#grad1)" stroke="#222" stroke-width="1"/>
    <rect id="lid" x="18" y="18" width="28" height="5" rx="3" ry="3" fill="#555"/>
    <rect x="18" y="18" width="28" height="2" rx="3" ry="3" fill="rgba(255,255,255,0.2)"/>
    <line x1="26" y1="26" x2="26" y2="46" stroke="#333" stroke-width="2"/>
    <line x1="32" y1="26" x2="32" y2="46" stroke="#333" stroke-width="2"/>
    <line x1="38" y1="26" x2="38" y2="46" stroke="#333" stroke-width="2"/>
  </svg>
</button>
<audio id="trashSound" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>

<script>
document.addEventListener('DOMContentLoaded', ()=>{

  const els = {
    busqueda: document.getElementById('busquedaRapida'),
    marca: document.getElementById('filtroMarca'),
    modelo: document.getElementById('filtroModelo'),
    anio: document.getElementById('filtroAnio'),
    oem: document.getElementById('filtroOem'),
    fmsi: document.getElementById('filtroFmsi'),
    medidasAncho: document.getElementById('medidasAncho'),
    medidasAlto: document.getElementById('medidasAlto'),
    datalistMarca: document.getElementById('marcas'),
    datalistModelo: document.getElementById('modelos'),
    datalistAnio: document.getElementById('anios'),
    datalistOem: document.getElementById('oemList'),
    datalistFmsi: document.getElementById('fmsiList'),
    posDel: document.getElementById('positionDelantera'),
    posTras: document.getElementById('positionTras'),
    results: document.getElementById('results-container'),
    count: document.getElementById('resultCount'),
    trashBtn: document.getElementById('trashBtn'),
    lid: document.getElementById('lid'),
    trashSound: document.getElementById('trashSound')
  };

  let brakePadsData = []; 

  fetch('pastillas.json')
    .then(res=>res.json())
    .then(data=>{ 
      brakePadsData = data; 
      updateDatalists();
      filterData(); 
    });

  const fillDatalist=(datalist,values)=>{
    datalist.innerHTML='';
    values.forEach(v=>datalist.innerHTML+=`<option value="${v}">`)
  }

  const updateDatalists=()=>{
    fillDatalist(els.datalistMarca,[...new Set(brakePadsData.map(d=>d.marca))].sort());
    fillDatalist(els.datalistModelo,[...new Set(brakePadsData.map(d=>d.modelo))].sort());
    fillDatalist(els.datalistAnio,[...new Set(brakePadsData.map(d=>d.año))].sort());
    fillDatalist(els.datalistOem,[...new Set(brakePadsData.map(d=>d.oem))].sort());
    fillDatalist(els.datalistFmsi,[...new Set(brakePadsData.map(d=>d.fmsi))].sort());
  }

  const getPos=()=> els.posDel.classList.contains('active') && els.posTras.classList.contains('active') ? 'Ambas' :
                     els.posDel.classList.contains('active') ? 'Delantera' :
                     els.posTras.classList.contains('active') ? 'Trasera':'Todas';

  const filterData=()=>{
    const fbusq=(val)=>val.toLowerCase().trim();
    const filters={
      busqueda: fbusq(els.busqueda.value),
      marca: els.marca.value,
      modelo: els.modelo.value,
      anio: els.anio.value,
      oem: els.oem.value,
      fmsi: els.fmsi.value,
      ancho: els.medidasAncho.value.trim(),
      alto: els.medidasAlto.value.trim(),
      pos: getPos()
    };

    const filtered=brakePadsData.filter(item=>{
      const busqMatch=!filters.busqueda || item.marca.toLowerCase().includes(filters.busqueda) ||
                      item.modelo.toLowerCase().includes(filters.busqueda) ||
                      item.ref?.toLowerCase().includes(filters.busqueda);
      const marcaMatch=!filters.marca || item.marca===filters.marca;
      const modeloMatch=!filters.modelo || item.modelo===filters.modelo;
      const anioMatch=!filters.anio || item.año===filters.anio;
      const oemMatch=!filters.oem || item.oem===filters.oem;
      const fmsiMatch=!filters.fmsi || item.fmsi===filters.fmsi;

      let anchoMatch = true, altoMatch = true;
      if(filters.ancho || filters.alto){
        const partes = item.medidas.split('x').map(s=>s.trim());
        anchoMatch = !filters.ancho || (partes[0] && partes[0].includes(filters.ancho));
        altoMatch = !filters.alto || (partes[1] && partes[1].includes(filters.alto));
      }

      const posMatch=filters.pos==='Todas' || filters.pos==='Ambas' ||
                     (filters.pos==='Delantera' && item.posición.includes('Del')) ||
                     (filters.pos==='Trasera' && item.posición.includes('Tras'));
      return busqMatch && marcaMatch && modeloMatch && anioMatch && oemMatch && fmsiMatch && anchoMatch && altoMatch && posMatch;
    });

    els.count.textContent=filtered.length;
    els.results.innerHTML=filtered.map(item=>{
      const posBadge = [];
      if(item.posición.includes('Del')) posBadge.push('<span class="position-badge position-delantera">Delantera</span>');
      if(item.posición.includes('Tras')) posBadge.push('<span class="position-badge position-trasera">Trasera</span>');
      return `<div class="result-card">
        <img src="${item.imagen}" alt="${item.marca} ${item.modelo}" class="result-image" loading="lazy">
        <div class="result-field"><strong>${item.marca} ${item.modelo}</strong></div>
        <div class="result-field">Año: ${item.año}</div>
        <div class="result-field">OEM: ${item.oem}</div>
        <div class="result-field">FMSI: ${item.fmsi}</div>
        <div class="result-field">${posBadge.join(' ')}</div>
        <div class="result-field">Medidas: ${item.medidas}</div>
      </div>`;
    }).join('');
  }

  [els.busqueda, els.marca, els.modelo, els.anio, els.oem, els.fmsi, els.medidasAncho, els.medidasAlto]
    .forEach(i=>i.addEventListener('input', filterData));
  [els.posDel, els.posTras].forEach(btn=>btn.addEventListener('click',()=>{ btn.classList.toggle('active'); filterData(); }));

  // Papelera animada = limpiar filtros
  els.trashBtn.addEventListener('mousemove', e => {
    const r = els.trashBtn.getBoundingClientRect();
    els.trashBtn.style.setProperty('--mx', `${e.clientX - r.left}px`);
    els.trashBtn.style.setProperty('--my', `${e.clientY - r.top}px`);
  });

  els.trashBtn.addEventListener('click', () => {
    // Sonido
    els.trashSound.currentTime = 0;
    els.trashSound.play();

    // Chispas
    for (let i = 0; i < 18; i++) {
      const s = document.createElement('div');
      s.className = 'lp-spark';
      const r = els.trashBtn.getBoundingClientRect();
      const size = Math.random() * 12 + 8;
      const dx = Math.random() * 140 - 70;
      const dy = Math.random() * 180 + 20;
      const colors = [
        'rgba(255,140,0,0.9)',
        'rgba(255,69,0,0.9)',
        'rgba(255,0,0,0.9)',
        'rgba(255,215,0,0.9)',
        'rgba(255,255,255,0.9)'
      ];
      s.style.cssText = `
        width:${size}px;
        height:${size*1.5}px;
        left:${r.left + r.width/2}px;
        top:${r.top + r.height/2}px;
        --dx:${dx}px;
        --dy:${dy}px;
        background:${colors[Math.floor(Math.random()*colors.length)]};
        filter:blur(${Math.random()*2+1}px);
        animation-duration:${0.5 + Math.random()*0.5}s;
      `;
      document.body.appendChild(s);
      setTimeout(() => s.remove(), 1500);
    }

    // Animación tapa
    els.lid.style.animation = 'lidOpen 0.35s ease';
    els.lid.addEventListener('animationend', () => { els.lid.style.animation = ''; }, {once: true});

    // Limpiar filtros
    els.busqueda.value=''; els.marca.value=''; els.modelo.value=''; els.anio.value='';
    els.oem.value=''; els.fmsi.value=''; els.medidasAncho.value=''; els.medidasAlto.value='';
    els.posDel.classList.remove('active'); els.posTras.classList.remove('active');
    filterData();
  });

});
</script>
</body>
</html>
